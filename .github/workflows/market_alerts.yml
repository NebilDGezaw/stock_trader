name: Market Alerts

on:
  # â”€â”€ Scheduled sessions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  schedule:
    # US MARKET OPEN: 9:30 AM ET = 14:30 UTC (Mon-Fri)
    # Stocks â†’ private DM | Commodities + Crypto â†’ group
    - cron: "30 14 * * 1-5"

    # LONDON SESSION: 8:00 AM UTC (Mon-Fri)
    # Forex â†’ private DM
    - cron: "0 8 * * 1-5"

  # â”€â”€ Manual trigger (for testing) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  workflow_dispatch:
    inputs:
      scan_type:
        description: "What to scan"
        required: false
        default: "all"
        type: choice
        options:
          - stocks_private
          - group_commodities_crypto
          - london_forex
          - all

jobs:
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  #  PRIVATE DM: Stocks (daily at NY open)
  #  MSTU, MSTR, TSLL always included + top US stocks
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  stocks-private:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    if: >-
      github.event.schedule == '30 14 * * 1-5' ||
      github.event.inputs.scan_type == 'stocks_private' ||
      github.event.inputs.scan_type == 'all'

    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.12"
          cache: "pip"
      - run: pip install yfinance pandas numpy

      - name: "ðŸ›ï¸ Stocks â†’ Private DM"
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: >-
          python -m alerts.telegram_bot
          --tickers MSTU MSTR TSLL SPY AAPL MSFT TSLA GOOGL NVDA META
          --label "ðŸ›ï¸ US Stocks â€” NY Open"
          --interval 1d --period 6mo

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  #  GROUP: Commodities + Major Crypto (daily at NY open)
  #  Gold, Silver + BTC, ETH, SOL, XRP
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  group-commodities-crypto:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    if: >-
      github.event.schedule == '30 14 * * 1-5' ||
      github.event.inputs.scan_type == 'group_commodities_crypto' ||
      github.event.inputs.scan_type == 'all'

    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.12"
          cache: "pip"
      - run: pip install yfinance pandas numpy

      - name: "ðŸ¥‡â‚¿ Commodities + Crypto â†’ Group"
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_GROUP_CHAT_ID }}
        run: >-
          python -m alerts.telegram_bot
          --tickers GC=F SI=F BTC-USD ETH-USD SOL-USD XRP-USD
          --label "ðŸ¥‡â‚¿ Commodities & Crypto"
          --interval 1h --period 1mo

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  #  PRIVATE DM: London Forex (EUR/USD, GBP/USD)
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  london-forex:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    if: >-
      github.event.schedule == '0 8 * * 1-5' ||
      github.event.inputs.scan_type == 'london_forex' ||
      github.event.inputs.scan_type == 'all'

    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.12"
          cache: "pip"
      - run: pip install yfinance pandas numpy

      - name: "ðŸ‡¬ðŸ‡§ London Forex â†’ Private DM"
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: >-
          python -m alerts.telegram_bot
          --tickers EURUSD=X GBPUSD=X
          --label "ðŸ‡¬ðŸ‡§ London Session â€” Forex"
          --interval 1h --period 1mo
